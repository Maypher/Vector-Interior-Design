FROM registry:3 AS base

ENV REGISTRY_AUTH=htpasswd
ENV REGISTRY_AUTH=htpasswd
ENV REGISTRY_AUTH_HTPASSWD_REALM="Registry Realm"
ENV REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd/htpasswd
ENV REGISTRY_STORAGE_DELETE_ENABLED=true
ENV REGISTRY_HTTP_DEBUG_PROMETHEUS_ENABLED=false
ENV OTEL_TRACES_EXPORTER=none
ENV OTEL_SDK_DISABLED=true
ENV REGISTRY_LOG_LEVEL=info

VOLUME [ "/var/lib/registry/" ]
EXPOSE 5000

FROM base AS dev

ENV REGISTRY_STORAGE=inmemory

